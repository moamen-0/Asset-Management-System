@{
    ViewData["Title"] = "Asset Transfers";
    Layout = "~/Views/Shared/_Dashboard.cshtml";
}
<style>
    a.btn-light {
        background-color: white !important; /* Primary blue */
        color: #0d6efd !important; /* White text on hover */
    }

</style>
<div class="container mt-4">
    <div class="card shadow-lg rounded-4 border-0">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
            <h3 class="fw-bold m-0"><i class="bi bi-arrow-left-right"></i> Asset Transfers</h3>
            <a asp-action="Create" class="btn btn-light text-primary rounded-pill px-4 shadow-sm">
                <i class="bi bi-plus-lg"></i> Add Transfer
            </a>
        </div>

        <div class="card-body">
            <div class="d-flex justify-content-end gap-2 mb-3">
                <button id="exportExcel" class="btn btn-outline-success rounded-pill px-3 shadow-sm">
                    <i class="bi bi-file-earmark-excel"></i> Export all to Excel
                </button>
                <button id="exportPdf" class="btn btn-outline-danger rounded-pill px-3 shadow-sm">
                    <i class="bi bi-file-earmark-pdf"></i> Export all to PDF
                </button>
            </div>

            <div class="table-responsive">
                <table id="assetTransfersTable" class="table table-hover table-bordered align-middle shadow-sm">
                    <thead class="table-dark text-center">
                        <tr>
                            <th><input type="checkbox" id="selectAll"></th>
                            <th><i class="fas fa-hashtag"></i> ID</th>
                            <th><i class="fas fa-random"></i> Transfer Type</th>
                            <th><i class="fas fa-calendar-alt"></i> Transfer Date</th>
                            <th><i class="fas fa-building"></i> From Department</th>
                            <th><i class="fas fa-building"></i> To Department</th>
                            <th><i class="fas fa-tag"></i> Asset Tag</th>
                            <th><i class="fas fa-info-circle"></i> Asset Description</th>
                            <th><i class="fas fa-cogs"></i> Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/select/1.3.4/css/select.bootstrap5.min.css">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/select/1.3.4/js/dataTables.select.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>

    <script>
        $(document).ready(function () {
            var table = $('#assetTransfersTable').DataTable({
                processing: true,
                serverSide: true,
                ajax: {
                    url: '@Url.Action("GetAssetTransfers", "AssetTransfer")',
                    type: 'POST'
                },
                select: {
                    style: 'multi',
                    selector: 'td:first-child input[type="checkbox"]'
                },
                columns: [
                    {
                        data: null,
                        orderable: false,
                        className: 'text-center',
                        render: function () {
                            return '<input type="checkbox" class="row-checkbox">';
                        }
                    },
                    { data: 'id' },
                    { data: 'transferType' },
                    { data: 'transferDate' },
                    { data: 'fromDepartment' },
                    { data: 'toDepartment' },
                    { data: 'assetTag' },
                    { data: 'assetDescription' },
                    {
                        data: 'id',
                        render: function (data) {
                            return `
                                <div class="d-flex justify-content-center gap-2">
                                    <a href="/AssetTransfer/Edit/${data}" class="btn btn-outline-warning btn-sm rounded-circle shadow-sm" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <a href="/AssetTransfer/Delete/${data}" class="btn btn-outline-danger btn-sm rounded-circle shadow-sm" title="Delete">
                                        <i class="fas fa-trash"></i>
                                    </a>
                                </div>`;
                        }
                    }
                ],
                dom: '<"row"<"col-md-6"B><"col-md-6"f>>rt<"row"<"col-md-5"i><"col-md-7"p>>',
                buttons: [
                    {
                        extend: 'excelHtml5',
                        text: '<i class="fas fa-file-excel"></i> Export Selected',
                        className: 'btn btn-outline-success btn-sm rounded-pill px-3 shadow-sm',
                        exportOptions: {
                            columns: [1, 2, 3, 4, 5, 6, 7],
                            modifier: { selected: true }
                        }
                    },
                    {
                        extend: 'pdfHtml5',
                        text: '<i class="fas fa-file-pdf"></i> Export Selected',
                        className: 'btn btn-outline-danger btn-sm rounded-pill px-3 shadow-sm',
                        exportOptions: {
                            columns: [1, 2, 3, 4, 5, 6, 7],
                            modifier: { selected: true }
                        }
                    }
                ],
                order: [[1, 'asc']]
            });

            $('#selectAll').on('click', function () {
                var isChecked = this.checked;
                $('.row-checkbox').each(function () {
                    this.checked = isChecked;
                    $(this).closest('tr').toggleClass('selected', isChecked);
                });
            });

            $('#assetTransfersTable tbody').on('click', 'input.row-checkbox', function () {
                var $row = $(this).closest('tr');
                if (this.checked) {
                    $row.addClass('selected');
                } else {
                    $row.removeClass('selected');
                }
            });
        });
    </script>
}
